import{w as e}from"./withConfigTransport.js";import{computed as t,ref as a,watch as r,defineComponent as o,toRefs as n,resolveComponent as s,openBlock as l,createElementBlock as i,createVNode as u,withCtx as p,renderSlot as c,normalizeProps as m,guardReactiveProps as d,mergeProps as v,toHandlers as f,createSlots as y,createBlock as j,createCommentVNode as V,withModifiers as D,renderList as g}from"vue";import{u as I,a as C}from"./VaInput.js";import{u as P,a as k}from"./index66.js";import{u as b,b as h}from"./useStateful.js";import{s as w,i as x,a as S,b as $}from"./VaDatePicker.js";import{e as _,a as B,f as F}from"./child-props.js";import T,{VaDropdownContent as L}from"./index25.js";import O from"./index31.js";import E from"./index28.js";import"./VaConfig.js";import"./global-config.js";import"./useForm.js";import"cleave.js";import"./useFocus.js";import"./useEmitProxy.js";import"./VaInputWrapper.js";import"./color-config.js";import"colortranslator";import"./pick.js";import"./VaIcon.js";import"./isSymbol.js";import"./flatten.js";import"./useSize.js";import"./useSyncProp.js";import"./consts.js";import"./useColor.js";import"./index9.js";import"./VaButton.js";import"./useTextColor.js";import"./useRouterLink.js";import"./useLoading.js";import"./index39.js";import"./clamp.js";import"./toNumber.js";import"./VaDropdown.js";import"./debounce.js";import"./ssr-utils.js";import"./VaMessageListWrapper.js";var N=function isNil(e){return null==e};const defaultParseDateFunction=e=>new Date(Date.parse(e)),useDateParser=e=>{const t=a(!0),parseDate=a=>{const r=(e.parseDate||defaultParseDateFunction)(a);var o;return t.value=(o=r)instanceof Date&&!isNaN(o.getTime()),r};return{parseDateInputValue:a=>{if(t.value=!0,e.parse)return e.parse(a,t);if((t=>t.includes(e.delimiter))(a))return a.split(e.delimiter).map(parseDate);if((t=>t.includes(e.rangeDelimiter))(a)){const[t,r]=a.split(e.rangeDelimiter).map(parseDate);return{start:t,end:r}}return parseDate(a)},isValid:t}},isRange=e=>"object"==typeof e&&("start"in e||"end"in e),parseSingleDate=e=>"string"==typeof e?defaultParseDateFunction(e):new Date(e),parseModelValue=e=>Array.isArray(e)?e.map(parseSingleDate):isRange(e)?{start:N(e.start)?e.start:parseSingleDate(e.start),end:N(e.end)?e.end:parseSingleDate(e.end)}:parseSingleDate(e),useRangeModelValueGuard=(e,o,n=parseModelValue)=>{const s=a(e.value&&n(e.value)),l=t({get:()=>s.value,set:t=>{o.value&&(e.value=t),t?(isRange(t)?null!==t.end&&(e.value=t):e.value=t,s.value=t):e.value=t}});r(e,(e=>{s.value=e}));return{valueComputed:l,reset:()=>{s.value&&isRange(s.value)&&(s.value=e.value&&n(e.value))}}},R=_(O,["mask","returnRaw","autosize","minRows","maxRows","type","inputmode"]);var z=o({name:"VaDateInput",components:{VaDropdown:T,VaDropdownContent:L,VaDatePicker:w,VaInput:O,VaIcon:E},props:{...R,..._(w),clearValue:{type:Date,default:void 0},resetOnClose:{type:Boolean,default:!0},isOpen:{type:Boolean,default:void 0},format:{type:Function},formatDate:{type:Function,default:e=>e.toLocaleDateString()},parse:{type:Function},parseDate:{type:Function},parseValue:{type:Function},delimiter:{type:String,default:", "},rangeDelimiter:{type:String,default:" ~ "},manualInput:{type:Boolean,default:!1},color:{type:String,default:"primary"},leftIcon:{type:Boolean,default:!1},icon:{type:String,default:"calendar_today"}},emits:[...B(w),...I,...P,...b,"update:is-open","update:text"],setup(e,{emit:o,slots:s}){const{isOpen:l,resetOnClose:i}=n(e),{valueComputed:u}=h(e,o),{syncProp:p}=function useSyncProp(e,r,o,n){if(void 0===n)return{syncProp:t({set(e){o(`update:${r}`,e)},get:()=>e.value})};const s=a(n);return{syncProp:t({set(e){s.value=e,o(`update:${r}`,e)},get:()=>void 0===(null==e?void 0:e.value)?s.value:e.value})}}(l,"is-open",o,!1),c=t((()=>!i.value)),{valueComputed:m,reset:d}=useRangeModelValueGuard(u,c,e.parseValue);r(p,(e=>{e||c.value||d()}));const dateOrNothing=t=>t?e.formatDate(t):"...",v=a(),{parseDateInputValue:f,isValid:y}=useDateParser(e),modelValueToString=t=>{if(e.format)return e.format(m.value);if(x(t))return t.map((t=>e.formatDate(t))).join(e.delimiter);if(S(t))return e.formatDate(t);if($(t))return dateOrNothing(t.start)+e.rangeDelimiter+dateOrNothing(t.end);throw new Error("VaDatePicker: Invalid model value. Value should be Date, Date[] or { start: Date, end: Date | null }")},j=t((()=>y.value?m.value?modelValueToString(m.value):e.clearValue?modelValueToString(e.clearValue):"":"")),reset=()=>{u.value=e.clearValue,o("clear")},focus=()=>{var e;null===(e=v.value)||void 0===e||e.focus()},{computedError:V,computedErrorMessages:D,listeners:g}=k(e,o,reset,focus),I=t((()=>!y.value&&m.value!==e.clearValue||V.value)),P=t((()=>{const t=[e.leftIcon&&"prependInner",(!e.leftIcon||e.clearable)&&"icon"];return Object.keys(s).filter((e=>!t.includes(e)))})),{canBeCleared:b,clearIconProps:B,onFocus:T,onBlur:L}=C(e,m),O=t((()=>({name:e.icon,color:e.color,size:"small",class:"va-date-input__icon"}))),E=t((()=>({...F(e,R).value,clearable:!1,rules:[],error:I.value,errorMessages:D.value,readonly:e.readonly||!e.manualInput}))),N=t((()=>({focus:()=>{T(),g.onFocus()},blur:()=>{L(),g.onBlur()}})));return{valueText:j,valueComputed:m,isOpenSync:p,onInputTextChanged:({target:e})=>{const t=f(e.value);y.value&&(m.value=t)},input:v,inputProps:E,inputListeners:N,datePickerProps:F(e,_(w)),filterSlots:P,canBeCleared:b,clearIconProps:B,iconProps:O,reset:reset,focus:focus,blur:()=>{var e;null===(e=v.value)||void 0===e||e.blur()}}}});const H={class:"va-date-input"};z.render=function render(e,t,a,r,o,n){const I=s("va-icon"),C=s("va-input"),P=s("va-date-picker"),k=s("va-dropdown-content"),b=s("va-dropdown");return l(),i("div",H,[u(b,{modelValue:e.isOpenSync,"onUpdate:modelValue":t[9]||(t[9]=t=>e.isOpenSync=t),offset:[2,0],"close-on-content-click":!1,disabled:e.disabled,anchorSelector:".va-input-wrapper__input"},{anchor:p((()=>[c(e.$slots,"input",m(d({valueText:e.valueText,inputProps:e.inputProps,inputListeners:e.inputListeners})),(()=>[u(C,v({ref:"input",class:"va-date-input__input"},e.inputProps,f(e.inputListeners),{"model-value":e.valueText,onChange:e.onInputTextChanged}),y({prependInner:p((t=>[c(e.$slots,"prependInner",m(d(t))),e.$props.leftIcon?(l(),j(I,m(v({key:0},e.iconProps)),null,16)):V("v-if",!0)])),icon:p((()=>[e.canBeCleared?(l(),j(I,v({key:0},e.clearIconProps,{onClick:t[0]||(t[0]=D((t=>e.reset()),["stop"]))}),null,16)):e.$props.leftIcon?V("v-if",!0):(l(),j(I,m(v({key:1},e.iconProps)),null,16))])),_:2},[g(e.filterSlots,(t=>({name:t,fn:p((a=>[c(e.$slots,t,m(d(a)))]))})))]),1040,["model-value","onChange"])]))])),default:p((()=>[u(k,null,{default:p((()=>[u(P,v(e.datePickerProps,{modelValue:e.valueComputed,"onUpdate:modelValue":t[1]||(t[1]=t=>e.valueComputed=t),"onClick:day":t[2]||(t[2]=t=>e.$emit("click:day",t)),"onClick:month":t[3]||(t[3]=t=>e.$emit("click:month",t)),"onClick:year":t[4]||(t[4]=t=>e.$emit("click:year",t)),"onHover:day":t[5]||(t[5]=t=>e.$emit("hover:day",t)),"onHover:month":t[6]||(t[6]=t=>e.$emit("hover:month",t)),"onHover:year":t[7]||(t[7]=t=>e.$emit("hover:year",t)),"onUpdate:view":t[8]||(t[8]=t=>e.$emit("update:view",t))}),y({_:2},[g(e.$slots,((t,a)=>({name:a,fn:p((t=>[c(e.$slots,a,m(d(t)))]))})))]),1040,["modelValue"])])),_:3})])),_:3},8,["modelValue","disabled"])])},z.__file="src/components/va-date-input/VaDateInput.vue";const M=e(z);export{M as VaDateInput};
//# sourceMappingURL=index23.js.map
