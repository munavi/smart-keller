import{ref as e,onMounted as t,onBeforeUnmount as a,watch as r,computed as o,defineComponent as l,nextTick as n,openBlock as s,createElementBlock as u,mergeProps as i,toRefs as d,resolveComponent as c,createBlock as p,createSlots as m,withCtx as g,createCommentVNode as v,withModifiers as y,renderSlot as f,normalizeProps as b,guardReactiveProps as h,renderList as x}from"vue";import{u as V}from"./useForm.js";import{b as w,u as k,a as S}from"./index66.js";import I from"cleave.js";import{u as P}from"./useFocus.js";import{u as B}from"./useEmitProxy.js";import{s as F}from"./VaInputWrapper.js";import{p as C}from"./pick.js";import{s as R,o as z}from"./VaIcon.js";import{f as E,e as _}from"./child-props.js";const j={creditCard:{creditCard:!0},date:{date:!0,datePattern:["d","m","Y"]},time:{time:!0,timePattern:["h","m"],timeFormat:"24"},numeral:{numeral:!0,numeralThousandsGroupStyle:"thousand"}},$={mask:{type:[String,Object],default:""},returnRaw:{type:Boolean,default:!0},modelValue:{type:String}},useCleave=(l,n,s)=>{const u=e(),destroyCleave=()=>{u.value&&u.value.destroy()},initCleave=()=>{var e;(destroyCleave(),l.value)&&(u.value=new I(l.value,"string"==typeof(e=n.mask)?j[e]?{...j[e]}:{}:{...e}))};t((()=>{initCleave()})),a((()=>{destroyCleave()})),r((()=>[l.value,n.mask]),(()=>{initCleave()}));const i=o((()=>u.value&&n.returnRaw&&n.modelValue===u.value.getRawValue()?u.value.getFormattedValue():n.modelValue));return{cleave:u,computedValue:i,onInput:e=>{const t=e.target.value;("string"===n.mask||Object.keys(n.mask).length)&&u.value&&(u.value.setRawValue(t),n.returnRaw)?s("update:modelValue",u.value.getRawValue()):s("update:modelValue",t)}}},A={clearable:{type:Boolean,default:!1},clearableIcon:{type:String,default:"highlight_off"},clearValue:{type:String,default:""}},H=["clear"],useClearable=(e,t,a,r,l)=>{const{isFocused:n,onFocus:s,onBlur:u}=P(r,a),i=[null,void 0,e.clearValue],d=o((()=>e.clearable&&!e.disabled&&!e.readonly&&!i.includes(t.value))),c=o((()=>(null==n?void 0:n.value)?e.color||"primary":(null==l?void 0:l.value)?"danger":e.success?"success":"gray")),p=o((()=>({name:e.clearableIcon,color:c.value,size:"small"})));return{canBeCleared:d,clearIconColor:c,clearIconProps:p,onFocus:s,onBlur:u}},M=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],getNodeHeightStyles=e=>{const t=window.getComputedStyle(e);return{boxSizing:t.getPropertyValue("box-sizing")||t.getPropertyValue("-moz-box-sizing")||t.getPropertyValue("-webkit-box-sizing"),padding:parseFloat(t.getPropertyValue("padding-bottom"))+parseFloat(t.getPropertyValue("padding-top")),border:parseFloat(t.getPropertyValue("border-bottom-width"))+parseFloat(t.getPropertyValue("border-top-width")),styles:M.map((e=>`${e}:${t.getPropertyValue(e)}`)).join(";")+";",lineHeight:parseInt(t.getPropertyValue("line-height"))}};let L=null;const createHiddenTextarea=(e,t)=>{L||(L=document.createElement("textarea")),L.setAttribute("style",t+"\n  min-height:0 !important;\n  max-height:none !important;\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important';\n"),L.value=e.value||e.placeholder||"";const a=e.getAttribute("wrap");return null!==a?L.setAttribute("wrap",a):L.removeAttribute("wrap"),L},positiveNumberValidator=e=>{if(e>0&&(0|e)===e)return!0;throw new Error(`\`minRows|maxRows\` must be a positive integer greater than 0, but ${e} is provided`)},{createEmits:T,createListeners:N}=B(["input","change","click","update:modelValue"]);var q=l({name:"VaTextarea",props:{...V,modelValue:{type:[String,Number],default:""},placeholder:{type:String},autosize:{type:Boolean,default:!1},minRows:{type:Number,default:1,validator:positiveNumberValidator},maxRows:{type:Number,validator:positiveNumberValidator}},emits:T(),setup(a,{emit:l}){const s=e(),u=e(-1),i=e(-1),{calculateRowHeight:d,calculateHeight:c}=(e=>({calculateRowHeight:()=>e.value?getNodeHeightStyles(e.value).lineHeight:0,calculateHeight:()=>{if(!e.value)return 0;const{boxSizing:t,padding:a,border:r,styles:o}=getNodeHeightStyles(e.value),l=createHiddenTextarea(e.value,o);document.body.appendChild(l);let n=l.scrollHeight;return"border-box"===t?n+=r:"content-box"===t&&(n-=a),document.body.removeChild(l),n}}))(s),p=o((()=>Boolean((a.autosize||a.maxRows||1!==a.minRows)&&s.value))),updateHeight=()=>{p.value&&(i.value=c())};t((()=>{p.value&&(u.value=d()),updateHeight()})),r((()=>a.modelValue),(()=>{n(updateHeight)}));const m=o((()=>({minHeight:u.value*a.minRows+"px",maxHeight:a.maxRows?u.value*a.maxRows+"px":void 0,height:i.value+"px",resize:p.value?void 0:"none"}))),g=o((()=>({...C(a,["disabled","readonly","placeholder"])})));return{textarea:s,computedStyle:m,listeners:N(l),computedProps:g}},methods:{focus(){var e;null===(e=this.textarea)||void 0===e||e.focus()},blur(){var e;null===(e=this.textarea)||void 0===e||e.blur()}}});const O=["value"];q.render=function render$1(e,t,a,r,o,l){return s(),u("textarea",i({ref:"textarea",class:"textarea"},{...e.computedProps,...e.listeners},{value:e.modelValue,style:e.computedStyle}),null,16,O)},q.__file="src/components/va-input/components/VaTextarea/VaTextarea.vue";const W=_(q),{createEmits:G,createListeners:Y}=B(["change","keyup","keypress","keydown","focus","blur"]),{createEmits:D,createListeners:J}=B(["click","click-prepend","click-append","click-prepend-inner","click-append-inner","click-icon"]);var K=l({name:"VaInput",components:{VaInputWrapper:F,VaTextarea:q,VaIcon:R},props:{...V,...w,...A,...$,...W,placeholder:{type:String,default:""},tabindex:{type:Number,default:0},modelValue:{type:[String,Number],default:""},label:{type:String,default:""},type:{type:String,default:"text"},loading:{type:Boolean,default:!1},inputClass:{type:String,default:""},pattern:{type:String},inputmode:{type:String,default:"text"},color:{type:String,default:"primary"},outline:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},requiredMark:{type:Boolean,default:!1}},emits:["update:modelValue",...k,...H,...G(),...D()],inheritAttrs:!1,setup(t,{emit:a,attrs:r,slots:l}){const n=e(),{isFocused:s,onFocus:u,onBlur:i}=P(),reset=()=>{a("update:modelValue",t.clearValue),a("clear")},c=o((()=>{const e=["icon"];return Object.keys(l).filter((t=>!e.includes(t)))})),{computedError:p,computedErrorMessages:m,listeners:g}=S(t,a,reset,(()=>{var e;null===(e=n.value)||void 0===e||e.focus()})),{modelValue:v}=d(t),{canBeCleared:y,clearIconProps:f}=useClearable(t,v,a,n,p),b=o((()=>"textarea"===t.type?void 0:n.value)),{computedValue:h,onInput:x}=useCleave(b,t,a),V=Y(a),w={...V,onFocus:e=>{V.onFocus(e),g.onFocus(),u()},onBlur:e=>{V.onBlur(e),g.onBlur(),i()},onInput:x},k=o((()=>({ariaLabel:t.label,class:t.inputClass,...z(r,["class","style"])}))),I=o((()=>({...k.value,...C(t,["type","tabindex","disabled","readonly","placeholder","pattern","inputmode"])})));return{input:n,inputEvents:w,computedChildAttributes:k,computedInputAttributes:I,textareaProps:E(t,W),computedValue:h,computedError:p,computedErrorMessages:m,isFocused:s,canBeCleared:y,clearIconProps:f,fieldListeners:J(a),reset:reset,filterSlots:c}},methods:{focus(){var e;null===(e=this.input)||void 0===e||e.focus()},blur(){var e;null===(e=this.input)||void 0===e||e.blur()}}});const Q=["value"];K.render=function render(e,t,a,r,o,l){const n=c("va-icon"),d=c("VaTextarea"),V=c("VaInputWrapper");return s(),p(V,i(e.fieldListeners,{class:e.$attrs.class,style:e.$attrs.style,color:e.color,readonly:e.readonly,disabled:e.disabled,success:e.success,messages:e.messages,error:e.computedError,"error-messages":e.computedErrorMessages,"error-count":e.errorCount,label:e.label,bordered:e.bordered,outline:e.outline,focused:e.isFocused,requiredMark:e.requiredMark,onClick:t[1]||(t[1]=t=>e.input&&e.input.focus())}),m({icon:g((a=>[e.success?(s(),p(n,{key:0,color:"success",name:"check_circle",size:"small"})):v("v-if",!0),e.computedError?(s(),p(n,{key:1,color:"danger",name:"warning",size:"small"})):v("v-if",!0),e.canBeCleared?(s(),p(n,i({key:2},e.clearIconProps,{onClick:t[0]||(t[0]=y((t=>e.reset()),["stop"]))}),null,16)):v("v-if",!0),e.loading?(s(),p(n,{key:3,color:e.color,size:"small",name:"loop",spin:"counter-clockwise"},null,8,["color"])):v("v-if",!0),f(e.$slots,"icon",b(h(a)))])),default:g((()=>["textarea"!==e.type||e.$slots.content?e.$slots.content?v("v-if",!0):(s(),u("input",i({key:1,ref:"input",class:"va-input__content__input"},{...e.computedInputAttributes,...e.inputEvents},{value:e.computedValue}),null,16,Q)):(s(),p(d,i({key:0,ref:"input"},{...e.computedChildAttributes,...e.textareaProps,...e.inputEvents},{class:"va-input__content__input"}),null,16))])),_:2},[x(e.filterSlots,(t=>({name:t,fn:g((a=>[f(e.$slots,t,b(h(a)))]))})))]),1040,["class","style","color","readonly","disabled","success","messages","error","error-messages","error-count","label","bordered","outline","focused","requiredMark"])},K.__file="src/components/va-input/VaInput.vue";export{useClearable as a,A as b,K as s,H as u};
//# sourceMappingURL=VaInput.js.map
