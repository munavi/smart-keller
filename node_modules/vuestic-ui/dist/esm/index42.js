import{w as e}from"./withConfigTransport.js";import{defineComponent as o,ref as t,computed as r,watch as n,resolveComponent as l,openBlock as a,createElementBlock as s,withKeys as p,withModifiers as i,Fragment as u,renderList as c,toDisplayString as d,createCommentVNode as v,normalizeClass as m,normalizeStyle as f,createBlock as h,createElementVNode as g,withDirectives as y,createVNode as O,vShow as b,nextTick as w,withCtx as S,createSlots as x,mergeProps as C,renderSlot as I,normalizeProps as k,guardReactiveProps as B}from"vue";import{u as j,a as T}from"./useSelectableList.js";import{u as V,b as $,a as _}from"./index66.js";import{u as A}from"./useForm.js";import{u as N}from"./useLoading.js";import{u as F,a as H}from"./useColor.js";import{u as P,b as D,a as E}from"./VaInput.js";import{u as L,h as M}from"./color-config.js";import{w as q}from"./utils.js";import G,{VaDropdownContent as K}from"./index25.js";import U from"./index28.js";import z from"./index31.js";import{u as R}from"./useFocus.js";import"./VaConfig.js";import"./global-config.js";import"./flatten.js";import"./useSyncProp.js";import"./consts.js";import"cleave.js";import"./useEmitProxy.js";import"./VaInputWrapper.js";import"./pick.js";import"./VaIcon.js";import"./isSymbol.js";import"./useSize.js";import"./child-props.js";import"colortranslator";import"./VaDropdown.js";import"./useStateful.js";import"./debounce.js";import"./toNumber.js";import"./ssr-utils.js";import"./useTextColor.js";import"./VaMessageListWrapper.js";const W={maxSelections:{type:[Number,String],default:void 0}};var J=o({name:"VaSelectOptionList",components:{VaIcon:U},emits:["select-option","update:hoveredOption","no-previous-option-to-hover","scroll-bottom"],props:{...F,options:{type:Array,default:()=>[]},noOptionsText:{type:String,default:"Items not found"},getSelectedState:{type:Function,required:!0},getText:{type:Function,required:!0},getTrackBy:{type:Function,required:!0},getGroupBy:{type:Function,required:!0},multiple:{type:Boolean,default:!1},search:{type:String,default:""},tabindex:{type:Number,default:0},hoveredOption:{type:[String,Number,Object],default:null}},setup(e,{emit:o}){const{getColor:l}=L(),a=t({}),s=t(null),p=r({get:()=>e.hoveredOption||null,set:e=>o("update:hoveredOption",e)}),i=r((()=>e.search?e.options.filter((o=>{const t=e.getText(o).toString().toUpperCase(),r=e.search.toUpperCase();return t.includes(r)})):e.options)),u=r((()=>i.value.reduce(((o,t)=>{if("object"==typeof t&&t.group){const r=e.getGroupBy(t);o[r]||(o[r]=[]),o[r].push(t)}else o._noGroup.push(t);return o}),{_noGroup:[]}))),isHovered=o=>!!p.value&&("string"==typeof o?o===p.value:!!e.getTrackBy&&e.getTrackBy(p.value)===e.getTrackBy(o)),updateHoveredOption=e=>{p.value=e||null},c=r((()=>i.value.findIndex((o=>!!p.value&&e.getTrackBy(o)===e.getTrackBy(p.value))))),scrollToOption=o=>{if(!o)return;const t=a.value[e.getTrackBy(o)];t&&((e,o={scrollTarget:e.parentElement,verticalAlignment:"any",smooth:!1})=>{const t=o.scrollTarget||e.parentElement,r=((e,o,t)=>{const r=o.offsetHeight,n=o.scrollTop,l=(e=>e.offsetTop)(e)-o.offsetTop,a=(e=>e.offsetTop+e.offsetHeight/2)(e)-o.offsetTop,s=(e=>e.offsetTop+e.offsetHeight)(e)-o.offsetTop;if("start"===t)return l;if("end"===t)return s-r;if("center"===t)return a-r/2;if("any"===t){if(l-n<0)return l;if(s-n>r)return s-r}})(e,t,o.verticalAlignment);void 0!==r&&t.scroll({top:r,behavior:o.smooth?"smooth":"auto"})})(t)};n((()=>e.hoveredOption),(e=>e&&scrollToOption(e)));const d={hoverPreviousOption:()=>{p.value?i.value[c.value-1]?p.value=i.value[c.value-1]:o("no-previous-option-to-hover"):i.value.length&&updateHoveredOption(i.value.at(-1))},hoverNextOption:()=>{p.value?i.value[c.value+1]&&(p.value=i.value[c.value+1]):i.value.length&&updateHoveredOption(i.value[0])},hoverFirstOption:()=>{i.value.length>0&&updateHoveredOption(i.value[0])},focus:()=>{var e;null===(e=s.value)||void 0===e||e.focus({preventScroll:!0})},scrollToOption:scrollToOption};return{rootElement:s,getColor:l,filteredOptions:i,optionGroups:u,onScroll:e=>{const t=e.target;t&&t.scrollTop+t.clientHeight===t.scrollHeight&&o("scroll-bottom")},beforeUpdate:()=>{a.value={}},setItemRef:o=>t=>{t&&(a.value[e.getTrackBy(o)]=t)},selectOption:e=>o("select-option",e),getOptionIcon:e=>"object"==typeof e?e.icon:void 0,getOptionClass:o=>({"va-select-option-list__option":!0,"va-select-option-list__option--selected":e.getSelectedState(o)}),getOptionStyle:o=>({color:e.getSelectedState(o)?l(e.color):"inherit",backgroundColor:isHovered(o)?M(l(e.color)):"transparent"}),updateHoveredOption:updateHoveredOption,...d}},methods:{hoverPreviousOption(){var e;null===(e=this.rootElement)||void 0===e||e.hoverPreviousOption()},hoverNextOption(){var e;null===(e=this.rootElement)||void 0===e||e.hoverNextOption()},hoverFirstOption(){var e;null===(e=this.rootElement)||void 0===e||e.hoverFirstOption()},focus(){var e;null===(e=this.rootElement)||void 0===e||e.focus()},scrollToOption(){var e;null===(e=this.rootElement)||void 0===e||e.scrollToOption()}}});const Q=["tabindex"],X={key:0,class:"va-select-option-list__group-name"},Y=["onClick","onMouseover"],Z={key:0,class:"va-select-option-list no-options"};J.render=function render$1(e,o,t,r,n,w){const S=l("va-icon");return a(),s("div",{class:"va-select-option-list",ref:"rootElement",tabindex:e.tabindex,onKeydown:[o[0]||(o[0]=p(i(((...o)=>e.hoverPreviousOption&&e.hoverPreviousOption(...o)),["stop","prevent"]),["up"])),o[1]||(o[1]=p(i(((...o)=>e.hoverPreviousOption&&e.hoverPreviousOption(...o)),["stop","prevent"]),["left"])),o[2]||(o[2]=p(i(((...o)=>e.hoverNextOption&&e.hoverNextOption(...o)),["stop","prevent"]),["down"])),o[3]||(o[3]=p(i(((...o)=>e.hoverNextOption&&e.hoverNextOption(...o)),["stop","prevent"]),["right"]))],onScrollPassive:o[4]||(o[4]=(...o)=>e.onScroll&&e.onScroll(...o))},[(a(!0),s(u,null,c(e.optionGroups,((o,t)=>(a(),s(u,{key:t},["_noGroup"!==t?(a(),s("span",X,d(t),1)):v("v-if",!0),(a(!0),s(u,null,c(o,(o=>(a(),s("div",{key:e.$props.getTrackBy(o),ref:e.setItemRef(o),class:m(e.getOptionClass(o)),style:f(e.getOptionStyle(o)),onClick:i((t=>e.selectOption(o)),["stop"]),onMouseover:t=>e.updateHoveredOption(o)},[e.getOptionIcon(o)?(a(),h(S,{key:0,size:"small",class:"va-select-option-list__option--icon",name:e.getOptionIcon(o)},null,8,["name"])):v("v-if",!0),g("span",null,d(e.getText(o)),1),y(O(S,{class:"va-select-option-list__option--selected-icon",size:"small",name:"done",color:e.getColor(e.$props.color)},null,8,["color"]),[[b,e.$props.getSelectedState(o)]])],46,Y)))),128))],64)))),128)),e.filteredOptions.length?v("v-if",!0):(a(),s("div",Z,d(e.noOptionsText),1))],40,Q)},J.__file="src/components/va-select/VaSelectOptionList/VaSelectOptionList.vue";var ee=o({name:"VaSelect",components:{VaSelectOptionList:e(J),VaIcon:U,VaDropdown:G,VaDropdownContent:K,VaInput:z},emits:["update:modelValue","update-search","create-new","scroll-bottom",...V,...P],props:{...j,...$,...N,...W,...D,...A,modelValue:{type:[String,Number,Object],default:""},placement:{type:String,default:"bottom",validator:e=>["top","bottom"].includes(e)},allowCreate:{type:[Boolean,String],default:!1,validator:e=>[!0,!1,"unique"].includes(e)},color:{type:String,default:"primary"},multiple:{type:Boolean,default:!1},searchable:{type:Boolean,default:!1},separator:{type:String,default:", "},width:{type:String,default:"100%"},maxHeight:{type:String,default:"256px"},noOptionsText:{type:String,default:"Items not found"},fixed:{type:Boolean,default:!0},hideSelected:{type:Boolean,default:!1},tabindex:{type:Number,default:0},dropdownIcon:{type:[String,Object],default:()=>({open:"expand_more",close:"expand_less"}),validator:e=>{if("string"==typeof e)return!0;const o="string"==typeof e.open,t="string"==typeof e.close;return o&&t}},outline:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},label:{type:String,default:""},placeholder:{type:String,default:""},requiredMark:{type:Boolean,default:!1}},setup(e,{emit:o}){const l=t(),a=t(),s=t(),{isFocused:p}=R(),{getHoverColor:i}=L(),{getOptionByValue:u,getValue:c,getText:d,getTrackBy:v,getGroupBy:m}=T(e),{validate:f,computedError:h,computedErrorMessages:g}=_(e,o,(()=>reset()),(()=>focus())),{colorComputed:y}=H(e),O=r((()=>e.readonly?i(y.value):y.value)),b=t(""),S=r((()=>e.searchable||e.allowCreate));n(b,(e=>{o("update-search",e),N.value=null}));const x=r({get(){const o=u(e.modelValue);return e.multiple?o?Array.isArray(o)?o:[o]:[]:Array.isArray(o)&&(q("Model value should be a string or a number for a single Select."),o.length)?o[o.length-1]:o},set(e){Array.isArray(e)?o("update:modelValue",e.map(c)):o("update:modelValue",c(e))}}),C=r((()=>x.value?"string"==typeof x.value||"number"==typeof x.value?x.value:Array.isArray(x.value)?x.value.map((e=>d(e))).join(e.separator)||e.clearValue:d(x.value):e.clearValue)),{canBeCleared:I,clearIconProps:k,onFocus:B,onBlur:j}=E(e,x),V=r((()=>e.multiple&&Array.isArray(x.value)?!!x.value.length:I.value)),$=r((()=>e.dropdownIcon?"string"==typeof e.dropdownIcon?e.dropdownIcon:F.value?e.dropdownIcon.close:e.dropdownIcon.open:"")),A=r((()=>e.options?e.hideSelected?e.options.filter((e=>!checkIsOptionSelected(e))):e.options:[])),checkIsOptionSelected=e=>!!x.value&&(Array.isArray(x.value)?!!x.value.find((o=>compareOptions(o,e))):compareOptions(x.value,e)),compareOptions=(e,o)=>{const t=c(e),r=c(o);return t===r||("string"==typeof t&&"string"==typeof r?t===r:null!==t&&null!==r&&("object"==typeof t&&"object"==typeof r&&v(t)===v(r)))},selectOption=r=>{var n;if(null!==N.value)if(S.value&&(b.value=""),e.multiple&&(n=x,Array.isArray(n.value))){const{exceedsMaxSelections:n,addOption:l}=function useMaxSelections(e,o,t){return{exceedsMaxSelections:()=>void 0!==o.value&&!isNaN(+o.value)&&e.value.length>=o.value,addOption:o=>{const r=[...e.value,o];t("update:modelValue",r)}}}(x,t(e.maxSelections),o);if(checkIsOptionSelected(c(r)))x.value=x.value.filter((e=>!compareOptions(c(r),c(e))));else{if(n())return;l(c(r))}}else x.value="string"==typeof r||"number"==typeof r?r:{...r},hideAndFocus();else hideAndFocus()},N=t(null),selectHoveredOption=()=>{N.value&&(F.value?selectOption(N.value):showDropdown())},F=t(!1),P=r({get:()=>F.value,set:e=>{e?showDropdown():hideDropdown()}}),D=r((()=>!(e.multiple||e.searchable||e.allowCreate))),showDropdown=()=>{e.disabled||e.readonly||(F.value=!0,scrollToSelected(),focusSearchOrOptions())},hideDropdown=()=>{F.value=!1,b.value="",f()},toggleDropdown=()=>{F.value?hideAndFocus():showDropdown()},hideAndFocus=()=>{var e;hideDropdown(),null===(e=a.value)||void 0===e||e.focus()},focusSearchBar=()=>{var e;null===(e=s.value)||void 0===e||e.focus()},focusOptionList=()=>{var o,t;null===(o=l.value)||void 0===o||o.focus(),!e.modelValue&&(null===(t=l.value)||void 0===t||t.hoverFirstOption())},focusSearchOrOptions=()=>w((()=>{S.value?focusSearchBar():focusOptionList()})),focus=()=>{var o;e.disabled||null===(o=a.value)||void 0===o||o.focus()},reset=()=>{e.multiple?x.value=Array.isArray(e.clearValue)?e.clearValue:[]:x.value=e.clearValue,b.value="",o("clear")},M=r((()=>e.disabled?-1:e.tabindex)),scrollToSelected=()=>{const e=x.value;if("object"!=typeof e&&Array.isArray(e)&&!e.length)return;const o=Array.isArray(e)?e[e.length-1]:e;N.value=o,w((()=>{var e;return null===(e=l.value)||void 0===e?void 0:e.scrollToOption(o)}))};let G,K="";const U=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Enter"," "];return{input:a,optionList:l,searchBar:s,onInputFocus:()=>{p.value=!0,B()},onInputBlur:()=>{P.value||(j(),p.value?p.value=!1:f())},focusOptionList:focusOptionList,reset:reset,onSelectClick:()=>{e.disabled||e.readonly||toggleDropdown()},focusSearchBar:focusSearchBar,searchInput:b,showSearchInput:S,hoveredOption:N,tabIndexComputed:M,valueComputed:x,valueComputedString:C,showClearIcon:V,toggleIcon:$,computedErrorMessages:g,computedError:h,filteredOptions:A,checkIsOptionSelected:checkIsOptionSelected,closeOnContentClick:D,selectOption:selectOption,selectOrAddOption:()=>{const t=!!e.allowCreate&&""!==b.value;null!==N.value?selectHoveredOption():t&&(()=>{var t;const r=null===(t=e.options)||void 0===t?void 0:t.some((e=>d(e)===b.value));"unique"===e.allowCreate&&r||(o("create-new",b.value),b.value="")})()},selectHoveredOption:selectHoveredOption,hoverPreviousOption:()=>{var e;null===(e=l.value)||void 0===e||e.hoverPreviousOption()},hoverNextOption:()=>{var e;null===(e=l.value)||void 0===e||e.hoverNextOption()},showDropdownContentComputed:P,showDropdown:showDropdown,hideDropdown:hideDropdown,hideAndFocus:hideAndFocus,toggleDropdown:toggleDropdown,toggleIconColor:O,onHintedSearch:o=>{if(U.some((e=>e===o.key)))return;const t=1===o.key.length,r="Backspace"===o.key||"Delete"===o.key;if(clearTimeout(G),r?K=K?K.slice(0,-1):"":t&&(K+=o.key),S.value)b.value=K;else{if(K){const o=e.options.find((e=>d(e).toLowerCase().startsWith(K.toLowerCase())));o&&(N.value=o)}G=setTimeout((()=>{K=""}),1e3)}},getText:d,getTrackBy:v,getGroupBy:m,onScrollBottom:()=>{o("scroll-bottom")},clearIconProps:k}},methods:{focus(){var e;this.$props.disabled||null===(e=this.input)||void 0===e||e.focus()},blur(){var e;this.showDropdownContentComputed&&(this.showDropdownContentComputed=!1),w(null===(e=this.input)||void 0===e?void 0:e.blur)}}});const oe={class:"va-select"},te={class:"va-select-dropdown__options-wrapper"};ee.render=function render(e,o,t,r,n,s){const u=l("va-icon"),c=l("va-input"),d=l("va-select-option-list"),m=l("va-dropdown-content"),y=l("va-dropdown");return a(),h(y,{ref:"dropdown",class:"va-select__dropdown va-select-dropdown",trigger:"none",anchorSelector:".va-input-wrapper__input",placement:e.$props.placement,disabled:e.$props.disabled,"max-height":e.$props.maxHeight,fixed:e.$props.fixed,"close-on-content-click":e.closeOnContentClick,stateful:!1,offset:[1,0],"keep-anchor-width":"",modelValue:e.showDropdownContentComputed,"onUpdate:modelValue":o[18]||(o[18]=o=>e.showDropdownContentComputed=o),onKeydown:[o[19]||(o[19]=p(i((o=>e.showDropdown()),["stop","prevent"]),["up"])),o[20]||(o[20]=p(i((o=>e.showDropdown()),["stop","prevent"]),["down"])),o[21]||(o[21]=p(i((o=>e.showDropdown()),["stop","prevent"]),["space"])),o[22]||(o[22]=p(i((o=>e.showDropdown()),["stop","prevent"]),["enter"]))],onClick:o[23]||(o[23]=i((o=>e.onSelectClick()),["prevent"]))},{anchor:S((()=>[g("div",oe,[O(c,{ref:"input","model-value":e.valueComputedString,success:e.$props.success,error:e.computedError,color:e.$props.color,label:e.$props.label,placeholder:e.$props.placeholder,loading:e.$props.loading,disabled:e.$props.disabled,outline:e.$props.outline,bordered:e.$props.bordered,"required-mark":e.$props.requiredMark,tabindex:e.tabIndexComputed,messages:e.$props.messages,"error-messages":e.computedErrorMessages,readonly:"",onFocus:o[1]||(o[1]=o=>e.onInputFocus()),onBlur:o[2]||(o[2]=o=>e.onInputBlur())},x({icon:S((()=>[e.showClearIcon?(a(),h(u,C({key:0},e.clearIconProps,{onClick:o[0]||(o[0]=i((o=>e.reset()),["stop"]))}),null,16)):v("v-if",!0)])),appendInner:S((()=>[e.$slots.appendInner?I(e.$slots,"appendInner",{key:0}):v("v-if",!0),O(u,{color:e.toggleIconColor,name:e.toggleIcon},null,8,["color","name"])])),_:2},[e.$slots.prepend?{name:"prepend",fn:S((()=>[I(e.$slots,"prepend")]))}:void 0,e.$slots.append?{name:"append",fn:S((()=>[I(e.$slots,"append")]))}:void 0,e.$slots.prependInner?{name:"prependInner",fn:S((()=>[I(e.$slots,"prependInner")]))}:void 0,e.$slots.content?{name:"content",fn:S((()=>[I(e.$slots,"content",k(B({valueString:e.valueComputedString,value:e.valueComputed})))]))}:void 0]),1032,["model-value","success","error","color","label","placeholder","loading","disabled","outline","bordered","required-mark","tabindex","messages","error-messages"])])])),default:S((()=>[O(m,{class:"va-select-dropdown__content",style:f({width:e.$props.width}),onKeyup:o[15]||(o[15]=p(i((()=>{}),["stop"]),["enter"])),onKeydown:[o[16]||(o[16]=p(i((()=>{}),["stop","prevent"]),["tab"])),o[17]||(o[17]=p(i((o=>e.hideAndFocus()),["prevent"]),["esc"]))]},{default:S((()=>[e.showSearchInput?(a(),h(c,{key:0,ref:"searchBar",class:"va-select__input",placeholder:"Search",tabindex:e.tabindex+1,bordered:!0,modelValue:e.searchInput,"onUpdate:modelValue":o[3]||(o[3]=o=>e.searchInput=o),onKeydown:[o[4]||(o[4]=p(i((o=>e.hoverPreviousOption()),["stop","prevent"]),["up"])),o[5]||(o[5]=p(i((o=>e.hoverPreviousOption()),["stop","prevent"]),["left"])),o[6]||(o[6]=p(i((o=>e.hoverNextOption()),["stop","prevent"]),["down"])),o[7]||(o[7]=p(i((o=>e.hoverNextOption()),["stop","prevent"]),["right"])),o[8]||(o[8]=p(i((o=>e.selectOrAddOption()),["prevent"]),["enter"]))],onFocus:o[9]||(o[9]=o=>e.hoveredOption=null)},null,8,["tabindex","modelValue"])):v("v-if",!0),g("div",te,[O(d,{ref:"optionList",hoveredOption:e.hoveredOption,"onUpdate:hoveredOption":o[10]||(o[10]=o=>e.hoveredOption=o),style:f({maxHeight:e.$props.maxHeight}),options:e.filteredOptions,"selected-value":e.valueComputed,"get-selected-state":e.checkIsOptionSelected,"get-text":e.getText,"get-track-by":e.getTrackBy,"get-group-by":e.getGroupBy,search:e.searchInput,"no-options-text":e.$props.noOptionsText,color:e.$props.color,tabindex:e.tabindex+1,onSelectOption:e.selectOption,onNoPreviousOptionToHover:o[11]||(o[11]=o=>e.focusSearchBar()),onKeydown:[o[12]||(o[12]=p(i((o=>e.selectHoveredOption()),["stop","prevent"]),["enter"])),o[13]||(o[13]=p(i((o=>e.selectHoveredOption()),["stop","prevent"]),["space"])),o[14]||(o[14]=p(i((o=>e.searchBar&&e.searchBar.focus()),["stop","prevent"]),["tab"])),e.onHintedSearch],onScrollBottom:e.onScrollBottom},null,8,["hoveredOption","style","options","selected-value","get-selected-state","get-text","get-track-by","get-group-by","search","no-options-text","color","tabindex","onSelectOption","onKeydown","onScrollBottom"])])])),_:1},8,["style"])])),_:3},8,["placement","disabled","max-height","fixed","close-on-content-click","modelValue"])},ee.__file="src/components/va-select/VaSelect.vue";const re=e(J);var ne=e(ee);export{re as VaSelectOptionList,ne as default};
//# sourceMappingURL=index42.js.map
