import{w as e}from"./withConfigTransport.js";import{defineComponent as l,resolveComponent as o,openBlock as a,createElementBlock as i,createVNode as t,withCtx as n,createElementVNode as r,createTextVNode as u,ref as d,createBlock as s,normalizeClass as m,toDisplayString as p,computed as f,onMounted as v,watch as c,createCommentVNode as g,normalizeStyle as y,Fragment as _,renderList as F,shallowRef as V,renderSlot as U}from"vue";import{i as b,u as h,d as S}from"./color-config.js";import j from"./index9.js";import B from"./index33.js";import D from"./index14.js";import I from"./index28.js";import"./VaConfig.js";import"./global-config.js";import"colortranslator";import"./VaButton.js";import"./useTextColor.js";import"./useColor.js";import"./useRouterLink.js";import"./useSize.js";import"./useLoading.js";import"./index39.js";import"./clamp.js";import"./toNumber.js";import"./isSymbol.js";import"./VaIcon.js";import"./flatten.js";import"./useStateful.js";import"./useAlign.js";var k=l({name:"VaFileUploadUndo",components:{VaButton:j},emits:["recover"]});const C={class:"va-file-upload-undo"},L=r("span",null,"File was successfully deleted",-1),R=u(" Undo ");k.render=function render$5(e,l,r,u,d,s){const m=o("va-button");return a(),i("div",C,[L,t(m,{onClick:l[0]||(l[0]=l=>e.$emit("recover")),outline:"",size:"small",class:"va-file-upload-undo__button"},{default:n((()=>[R])),_:1})])},k.__file="src/components/va-file-upload/VaFileUploadUndo/VaFileUploadUndo.vue";var x=e(k),z=l({name:"VaFileUploadListItem",components:{VaIcon:I,VaCard:D,VaFileUploadUndo:x},emits:["remove"],props:{file:{type:Object,default:null},color:{type:String,default:"success"},undo:{type:Boolean,default:!1},undoDuration:{type:Number,default:3e3}},setup(e,{emit:l}){const o=d(!1);return{removed:o,removeFile:()=>{e.undo?(o.value=!0,setTimeout((()=>{o.value&&(l("remove"),o.value=!1)}),e.undoDuration)):(l("remove"),o.value=!1)},recoverFile:()=>{o.value=!1}}}});const T={key:1,class:"va-file-upload-list-item__content"},w={class:"va-file-upload-list-item__name"},$={class:"va-file-upload-list-item__size"};z.render=function render$4(e,l,u,d,f,v){const c=o("va-file-upload-undo"),g=o("va-icon"),y=o("va-card");return a(),s(y,{class:m(["va-file-upload-list-item",{"file-upload-list-item--undo":e.removed}]),stripe:e.removed&&e.undo,stripeColor:e.color,"no-margin":"","no-padding":""},{default:n((()=>[e.removed&&e.undo?(a(),s(c,{key:0,onRecover:e.recoverFile},null,8,["onRecover"])):(a(),i("div",T,[r("div",w,p(e.file&&e.file.name),1),r("div",$,p(e.file&&e.file.size),1),t(g,{color:"danger",name:"clear",onClick:l[0]||(l[0]=l=>e.removeFile()),class:"va-file-upload-list-item__delete"})]))])),_:1},8,["stripe","stripeColor","class"])},z.__file="src/components/va-file-upload/VaFileUploadListItem/VaFileUploadListItem.vue";var A=e(z),M=l({name:"VaFileUploadGalleryItem",components:{VaFileUploadUndo:x,VaButton:j},emits:["remove"],props:{file:{type:Object,default:null},color:{type:String,default:"success"},undo:{type:Boolean,default:!1},undoDuration:{type:Number,default:3e3}},setup(e,{emit:l}){const o=d(""),a=d(!1),i=d(!1),t=f((()=>({backgroundColor:b(e.color,.7)}))),convertToImg=()=>{if(e.file.name&&e.file.image)if(e.file.image.url)o.value=e.file.image.url;else if(e.file.image instanceof File){const l=new FileReader;l.readAsDataURL(e.file.image),l.onload=e=>{var l,a;(null===(l=e.target)||void 0===l?void 0:l.result).includes("image")&&(o.value=null===(a=e.target)||void 0===a?void 0:a.result)}}};return v(convertToImg),c((()=>e.file),convertToImg),{previewImage:o,removed:a,isFocused:i,recoverImage:()=>{a.value=!1},overlayStyles:t,removeImage:()=>{e.undo?(a.value=!0,setTimeout((()=>{a.value&&(l("remove"),a.value=!1)}),e.undoDuration)):(l("remove"),a.value=!1)}}}});const G=["src"],N={class:"va-file-upload-gallery-item__overlay"},H=["title"];M.render=function render$3(e,l,n,u,d,s){const f=o("va-file-upload-undo"),v=o("va-button");return e.removed&&e.undo?(a(),i("div",{key:0,class:m(["va-file-upload-gallery-item",{"va-file-upload-gallery-item--undo":e.removed}])},[t(f,{class:"va-file-upload-gallery-item--undo",onRecover:e.recoverImage},null,8,["onRecover"])],2)):(a(),i("div",{key:1,tabindex:"0",class:m(["va-file-upload-gallery-item",{"file-upload-gallery-item_not-image":!e.previewImage,"va-file-upload-gallery-item--focused":e.isFocused}]),onFocus:l[2]||(l[2]=l=>e.isFocused=!0),onBlur:l[3]||(l[3]=l=>e.isFocused=!1)},[e.previewImage?(a(),i("img",{key:0,src:e.previewImage,alt:"",class:"va-file-upload-gallery-item__image"},null,8,G)):g("v-if",!0),r("div",N,[r("div",{class:"va-file-upload-gallery-item__overlay-background",style:y(e.overlayStyles)},null,4),r("div",{class:"va-file-upload-gallery-item__name",title:e.file.name},p(e.file.name),9,H),t(v,{flat:"",color:"danger",icon:"delete_outline",class:"va-file-upload-gallery-item__delete",onClick:e.removeImage,onFocus:l[0]||(l[0]=l=>e.isFocused=!0),onBlur:l[1]||(l[1]=l=>e.isFocused=!1)},null,8,["onClick"])])],34))},M.__file="src/components/va-file-upload/VaFileUploadGalleryItem/VaFileUploadGalleryItem.vue";var O=e(M),Z=l({name:"VaFileUploadSingleItem",components:{VaButton:j},emits:["remove"],props:{file:{type:Object,default:null}}});const E={class:"va-file-upload-single-item"},K={class:"va-file-upload-single-item__name"},P=u(" Delete ");Z.render=function render$2(e,l,u,d,s,m){const f=o("va-button");return a(),i("div",E,[r("div",K,p(e.file&&e.file.name),1),t(f,{flat:"",onClick:l[0]||(l[0]=l=>e.$emit("remove")),color:"danger",size:"small",class:"va-file-upload-single-item__button"},{default:n((()=>[P])),_:1})])},Z.__file="src/components/va-file-upload/VaFileUploadSingleItem/VaFileUploadSingleItem.vue";var Y=e(Z),q=l({name:"VaFileUploadList",components:{VaFileUploadListItem:A,VaFileUploadGalleryItem:O,VaFileUploadSingleItem:Y},emits:["remove","removeSingle"],props:{type:{type:String,default:""},files:{type:Array,default:null},color:{type:String,default:"success"},undo:{type:Boolean,default:!1},undoDuration:{type:Number,default:3e3}},setup(e){const l=f((()=>e.files.map(convertFile))),convertFile=e=>({name:e.name||e.url||"",size:formatSize(e.size),date:formatDate(new Date),image:e}),formatSize=e=>{if(0===e)return"0 Bytes";if(!e)return"";const l=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,l)).toFixed(2))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][l]},formatDate=(e=new Date)=>e.toLocaleDateString("en-US",{hour:"2-digit",minute:"2-digit",month:"short",day:"numeric",year:"numeric"});return{filesList:l}}});q.render=function render$1(e,l,t,n,r,u){const d=o("va-file-upload-list-item"),p=o("va-file-upload-gallery-item"),f=o("va-file-upload-single-item");return a(),i("div",{class:m(["va-file-upload-list",`va-file-upload-list--${e.type}`])},["list"===e.type?(a(!0),i(_,{key:0},F(e.filesList,((l,o)=>(a(),s(d,{key:l.name,file:l,color:e.color,undo:e.undo,undoDuration:e.undoDuration,onRemove:l=>e.$emit("remove",o)},null,8,["file","color","undo","undoDuration","onRemove"])))),128)):g("v-if",!0),"gallery"===e.type?(a(!0),i(_,{key:1},F(e.filesList,((l,o)=>(a(),s(p,{file:l,key:l.name,color:e.color,undo:e.undo,undoDuration:e.undoDuration,onRemove:l=>e.$emit("remove",o)},null,8,["file","color","undo","undoDuration","onRemove"])))),128)):g("v-if",!0),"single"===e.type&&e.filesList.length?(a(),s(f,{key:2,file:e.filesList[e.filesList.length-1],onRemove:l[0]||(l[0]=l=>e.$emit("removeSingle"))},null,8,["file"])):g("v-if",!0)],2)},q.__file="src/components/va-file-upload/VaFileUploadList/VaFileUploadList.vue";var J=e(q),Q=l({name:"VaFileUpload",components:{VaModal:B,VaButton:j,VaFileUploadList:J},props:{fileTypes:{type:String,default:""},dropzone:{type:Boolean,default:!1},color:{type:String,default:"primary"},disabled:{type:Boolean,default:!1},undo:{type:Boolean,default:!1},undoDuration:{type:Number,default:3e3},dropZoneText:{type:String,default:"Drag’n’drop files or"},uploadButtonText:{type:String,default:"Upload file"},modelValue:{type:Array,default:()=>[],validator:e=>Array.isArray(e)},type:{type:String,default:"list",validator:e=>["list","gallery","single"].includes(e)}},emits:["update:modelValue","file-removed","file-added"],setup(e,{emit:l}){const o=d(!1),a=d(!1),i=V(null),{getColor:t}=h(),n=f((()=>t(e.color))),r=f((()=>e.dropzone?{backgroundColor:S(n.value,{a:a.value?-.82:-.92})}:{backgroundColor:"transparent"})),u=f({get:()=>e.modelValue,set(e){l("update:modelValue",e)}}),validateFiles=l=>l.filter((l=>{const a=l.name||l.url;if(!a)return!1;if(l.url)return!0;if(["audio/*","video/*","image/*"].find((l=>e.fileTypes.includes(l))))return!0;const i=a.substring(a.lastIndexOf(".")+1).toLowerCase(),t=e.fileTypes.includes(i);return t||(o.value=!0),t})),uploadFile=o=>{var a,i;const t=(null===(a=o.target)||void 0===a?void 0:a.files)||(null===(i=o.dataTransfer)||void 0===i?void 0:i.files);if(!t)return;const n=e.fileTypes?validateFiles(Array.from(t)):t;u.value=[...u.value,...n],l("file-added",n)};return v((()=>{Array.isArray(u.value)&&(u.value=validateFiles(u.value))})),{modal:o,dropzoneHighlight:a,fileInputRef:i,colorComputed:n,computedStyle:r,uploadFile:uploadFile,changeFieldValue:e=>{uploadFile(e),i.value&&(i.value.value="")},files:u,removeFile:e=>{if(e in u.value){const o=u.value[e];u.value=u.value.filter(((l,o)=>o!==e)),l("file-removed",o)}},removeSingleFile:()=>{if(u.value.length>0){const e=u.value[0];u.value=[],l("file-removed",e)}},callFileDialogue:()=>{i.value&&i.value.click()}}}});const W={class:"va-file-upload__field"},X={key:0,class:"va-file-upload__field__text"},ee=["accept","multiple","disabled"];Q.render=function render(e,l,d,f,v,c){const _=o("va-button"),F=o("va-file-upload-list"),V=o("va-modal");return a(),i("div",{class:m(["va-file-upload",{"va-file-upload--dropzone":e.dropzone}]),style:y(e.computedStyle)},[U(e.$slots,"default",{},(()=>[r("div",W,[e.dropzone?(a(),i("div",X,p(e.dropZoneText),1)):g("v-if",!0),t(_,{class:"va-file-upload__field__button",disabled:e.disabled,color:e.colorComputed,onChange:e.changeFieldValue,onClick:l[0]||(l[0]=l=>e.callFileDialogue()),style:y({"pointer-events":e.dropzoneHighlight?"none":""})},{default:n((()=>[u(p(e.uploadButtonText),1)])),_:1},8,["disabled","color","onChange","style"])])])),r("input",{ref:"fileInputRef",type:"file",class:"va-file-upload__field__input",accept:e.fileTypes,multiple:"single"!==e.type,disabled:e.disabled,onChange:l[1]||(l[1]=(...l)=>e.changeFieldValue&&e.changeFieldValue(...l)),onDragenter:l[2]||(l[2]=l=>e.dropzoneHighlight=!0),onDragleave:l[3]||(l[3]=l=>e.dropzoneHighlight=!1),tabindex:"-1"},null,40,ee),e.files.length?(a(),s(F,{key:0,type:e.type,files:e.files,color:e.colorComputed,undo:e.undo,undoDuration:e.undoDuration,onRemove:e.removeFile,onRemoveSingle:e.removeSingleFile},null,8,["type","files","color","undo","undoDuration","onRemove","onRemoveSingle"])):g("v-if",!0),t(V,{modelValue:e.modal,"onUpdate:modelValue":l[4]||(l[4]=l=>e.modal=l),"hide-default-actions":"",title:"File validation",message:"File type is incorrect!"},null,8,["modelValue"])],6)},Q.__file="src/components/va-file-upload/VaFileUpload.vue";var le=e(Q);export{O as VaFileUploadGalleryItem,J as VaFileUploadList,A as VaFileUploadListItem,Y as VaFileUploadSingleItem,x as VaFileUploadUndo,le as default};
//# sourceMappingURL=index26.js.map
