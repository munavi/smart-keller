import{w as e}from"./withConfigTransport.mjs";import{defineComponent as a,ref as l,computed as r,onMounted as t,onBeforeUnmount as o,watch as i,resolveComponent as s,openBlock as n,createElementBlock as u,normalizeClass as v,renderSlot as d,createCommentVNode as c,normalizeStyle as m,createTextVNode as p,toDisplayString as y,createVNode as f,createElementVNode as b,Fragment as k,renderList as A,normalizeProps as h,guardReactiveProps as g}from"vue";import{u as _,h as C}from"./color-config.mjs";import{w}from"./utils.mjs";import x from"./index28.mjs";import"./VaConfig.mjs";import"./global-config.mjs";import"colortranslator";import"./VaIcon.mjs";import"./isSymbol.mjs";import"./flatten.mjs";import"./useSize.mjs";const validateSlider=(e,a,l,r)=>{r<l&&w("The maximum value can not be less than the minimum value."),l>r&&w("The minimum value can not be greater than the maximum value."),(r-l)%a!=0&&w("Step is illegal. Slider is nondivisible.");const inRange=e=>{e<l?w(`The value of the slider is ${e}, the minimum value is ${l}, the value of this slider can not be less than the minimum value`):e>r&&w(`The value of the slider is ${e}, the maximum value is ${r}, the value of this slider can not be greater than the maximum value`)};return Array.isArray(e)?e.map((e=>inRange(e))):inRange(e),!0};var L=a({name:"VaSlider",components:{VaIcon:x},emits:["drag-start","drag-end","change","update:modelValue"],props:{range:{type:Boolean,default:!1},modelValue:{type:[Number,Array],default:()=>[]},trackLabel:{type:[Function,String]},color:{type:String,default:"primary"},trackColor:{type:String,default:""},labelColor:{type:String,default:""},trackLabelVisible:{type:Boolean,default:!1},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},label:{type:String,default:""},invertLabel:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},pins:{type:Boolean,default:!1},iconPrepend:{type:String,default:""},iconAppend:{type:String,default:""},vertical:{type:Boolean,default:!1},showTrack:{type:Boolean,default:!0}},setup(e,{emit:a}){const{getColor:s}=_(),n=l(),u=l(),v=l(),d=l(),c=l(!1),m=l(!1),p=l(0),y=l(0),f=l(e.modelValue),b=l(0),k=l(!1),A=r((()=>e.vertical?[1,0]:[0,1])),h=r((()=>e.vertical?"bottom":"left")),g=r((()=>e.vertical?"height":"width")),w=r((()=>Array.isArray(T.value)&&T.value[1]-e.step<T.value[0])),x=r((()=>Array.isArray(T.value)&&T.value[0]+e.step>T.value[1])),L=r((()=>({"va-slider--active":c.value,"va-slider--disabled":e.disabled,"va-slider--readonly":e.readonly,"va-slider--horizontal":!e.vertical,"va-slider--vertical":e.vertical}))),S=r((()=>e.range?[{"va-slider__handler--inactive":!c.value},{"va-slider__handler--inactive":!c.value}]:{"va-slider__handler--on-focus":!e.range&&(m.value||c),"va-slider__handler--inactive":!c.value})),V=r((()=>({color:e.labelColor?s(e.labelColor):s(e.color)}))),$=r((()=>({backgroundColor:e.trackColor?s(e.trackColor):C(s(e.color))}))),E=r((()=>{const a=limitValue(e.modelValue);if(Array.isArray(a)){const l=(a[0]-e.min)/(e.max-e.min)*100,r=(a[1]-e.min)/(e.max-e.min)*100;return{[h.value]:`${l}%`,[g.value]:r-l+"%",backgroundColor:s(e.color),visibility:e.showTrack?"visible":"hidden"}}{const l=(a-e.min)/(e.max-e.min)*100;return{[g.value]:`${l}%`,backgroundColor:s(e.color),visibility:e.showTrack?"visible":"hidden"}}})),D=r((()=>{const a=limitValue(e.modelValue);if(Array.isArray(a)){const l=(a[0]-e.min)/(e.max-e.min)*100,r=(a[1]-e.min)/(e.max-e.min)*100;return[{[h.value]:`${l}%`,backgroundColor:isActiveDot(0)?s(e.color):"#ffffff",borderColor:s(e.color)},{[h.value]:`${r}%`,backgroundColor:isActiveDot(1)?s(e.color):"#ffffff",borderColor:s(e.color)}]}{const l=(a-e.min)/(e.max-e.min)*100;return{[h.value]:`${l}%`,backgroundColor:isActiveDot(0)?s(e.color):"#ffffff",borderColor:s(e.color)}}})),T=r({get:()=>e.modelValue,set:l=>{e.range||(l=limitValue(l)),m.value||a("change",l),a("update:modelValue",l)}}),B=r((()=>{const a=(e.max-e.min)/e.step;return y.value/a})),F=r((()=>{const a=`${e.step}`.split(".")[1];return a?Math.pow(10,a.length):1})),j=r((()=>(e.max-e.min)/e.step-1)),P=r((()=>Array.isArray(e.modelValue)?[(e.modelValue[0]-e.min)/e.step*B.value,(e.modelValue[1]-e.min)/e.step*B.value]:(e.modelValue-e.min)/e.step*B.value)),M=r((()=>[0,y.value])),O=r((()=>[e.min,e.max])),isActiveDot=a=>!(!c.value&&!m.value||e.disabled||e.readonly)&&(e.range?b.value===a:0===b.value),moveStart=(l,r=b.value)=>{var t,o;if(l.preventDefault(),!r)if(e.range){if(Array.isArray(P.value)){r=getPos(l instanceof TouchEvent?l.touches[0]:l)>(P.value[1]-P.value[0])/2+P.value[0]?1:0}}else r=0;Array.isArray(e.modelValue)&&(b.value=r),Array.isArray(e.modelValue)?null===(t=(0===r?u:v).value)||void 0===t||t.focus():null===(o=n.value)||void 0===o||o.focus(),m.value=!0,a("drag-start")},moving=a=>{k.value&&m.value&&!e.disabled&&!e.readonly&&setValueOnPos(getPos("touches"in a?a.touches[0]:a))},moveEnd=()=>{if(!e.disabled&&!e.readonly){if(!m.value)return!1;a("drag-end"),a("change",e.modelValue),m.value=!1,k.value=!1}},moveWithKeys=a=>{var l,r;if(![u.value,v.value,n.value].includes(document.activeElement))return;if(e.disabled||e.readonly)return;const moveDot=(a,l,r)=>{if(a&&Array.isArray(T.value)){if(!e.pins)return T.value.splice(r,1,T.value[r]+(l?e.step:-e.step));const a=(e.max-e.min)/(j.value+1);let t=(T.value[r]/a|0)*a;T.value[r]!==t?(t+=l?a:0,T.value.splice(r,1,t)):T.value.splice(r,1,T.value[r]+(l?e.step:-e.step))}else{if(!e.pins&&!Array.isArray(T.value))return void(T.value+=l?e.step:-e.step);const a=(e.max-e.min)/(j.value+1);let r=(Array.isArray(T.value)?0:T.value/a|0)*a;T.value!==r?(r+=l?a:0,T.value=r):T.value+=l?e.step:-e.step}};["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(a.key)&&a.preventDefault();const isActive=e=>e===document.activeElement;if(e.range&&Array.isArray(T.value)){const isVerticalDot0More=a=>e.vertical&&isActive(u.value)&&"ArrowUp"===a.key,isVerticalDot0Less=a=>e.vertical&&isActive(u.value)&&"ArrowDown"===a.key,isVerticalDot1More=a=>e.vertical&&isActive(v.value)&&"ArrowUp"===a.key,isVerticalDot1Less=a=>e.vertical&&isActive(v.value)&&"ArrowDown"===a.key,isHorizontalDot0Less=a=>!e.vertical&&isActive(u.value)&&"ArrowLeft"===a.key,isHorizontalDot0More=a=>!e.vertical&&isActive(u.value)&&"ArrowRight"===a.key,isHorizontalDot1Less=a=>!e.vertical&&isActive(v.value)&&"ArrowLeft"===a.key,isHorizontalDot1More=a=>!e.vertical&&isActive(v.value)&&"ArrowRight"===a.key;switch(!0){case(isVerticalDot1Less(a)||isHorizontalDot1Less(a))&&w.value&&T.value[0]!==e.min:null===(l=u.value)||void 0===l||l.focus(),moveDot(!0,0,0);break;case(isVerticalDot0More(a)||isHorizontalDot0More(a))&&x.value&&T.value[1]!==e.max:null===(r=v.value)||void 0===r||r.focus(),moveDot(!0,1,1);break;case(isVerticalDot0Less(a)||isHorizontalDot0Less(a))&&T.value[0]!==e.min:moveDot(!0,0,0);break;case(isVerticalDot1More(a)||isHorizontalDot1More(a))&&T.value[1]!==e.max:moveDot(!0,1,1);break;case(isVerticalDot1Less(a)||isHorizontalDot1Less(a))&&T.value[1]!==e.min:moveDot(!0,0,1);break;case(isVerticalDot0More(a)||isHorizontalDot0More(a))&&T.value[0]!==e.max:moveDot(!0,1,0)}}else e.vertical?("ArrowDown"===a.key&&moveDot(!1,0,0),"ArrowUp"===a.key&&moveDot(!1,1,0)):("ArrowLeft"===a.key&&moveDot(!1,0,0),"ArrowRight"===a.key&&moveDot(!1,1,0))},checkActivePin=a=>Array.isArray(T.value)?a*e.step>T.value[0]&&a*e.step<T.value[1]:a*e.step<T.value,R=r((()=>e.step/(e.max-e.min)*100)),getPos=a=>(getStaticData(),e.vertical?p.value-a.clientY:a.clientX-p.value),getStaticData=()=>{d.value&&(y.value=d.value[e.vertical?"offsetHeight":"offsetWidth"],p.value=d.value.getBoundingClientRect()[h.value])},getValueByIndex=a=>(e.step*F.value*a+e.min*F.value)/F.value,setCurrentValue=a=>{const l=b.value;if(Array.isArray(T.value)&&Array.isArray(f.value)&&Array.isArray(e.modelValue))isDiff(f.value[l],a)&&(f.value.splice(l,1,a),0===l?(T.value=[f.value.splice(l,1,a)[0],e.modelValue[1]],f.value=[...T.value]):(T.value=[e.modelValue[0],f.value.splice(l,1,a)[0]],f.value=[...T.value]));else{if(a<e.min||a>e.max)return!1;isDiff(f.value,a)&&(f.value=a,T.value=a)}},setValueOnPos=a=>{const l=M.value,r=O.value,t=Array.isArray(e.modelValue)?b.value?v.value:u.value:n.value;if(null==t||t.focus(),a>=l[0]&&a<=l[1])if(b.value){Array.isArray(P.value)&&Array.isArray(T.value)&&a<=P.value[0]&&(T.value[1]=T.value[0],b.value=0);const e=getValueByIndex(Math.round(a/B.value));setCurrentValue(e)}else{Array.isArray(P.value)&&Array.isArray(T.value)&&a>=P.value[1]&&(T.value[0]=T.value[1],b.value=1);const e=getValueByIndex(Math.round(a/B.value));setCurrentValue(e)}else a<l[0]?setCurrentValue(r[0]):setCurrentValue(r[1])},limitValue=a=>{const inRange=a=>a<e.min?e.min:a>e.max?e.max:a;if(Array.isArray(a)){if(a[0]>=a[1]&&0===b.value){const e=inRange(a[1]);return[e,e]}if(a[0]>=a[1]&&1===b.value){const e=inRange(a[0]);return[e,e]}return a.map((e=>inRange(e)))}return inRange(a)},isDiff=(e,a)=>JSON.stringify(e)!==JSON.stringify(a);return t((()=>{validateSlider(e.modelValue,e.step,e.min,e.max)&&(getStaticData(),document.addEventListener("mousemove",moving),document.addEventListener("touchmove",moving),document.addEventListener("mouseup",moveEnd),document.addEventListener("mouseleave",moveEnd),document.addEventListener("touchcancel",moveEnd),document.addEventListener("touchend",moveEnd),document.addEventListener("keydown",moveWithKeys))})),o((()=>{document.removeEventListener("mousemove",moving),document.removeEventListener("touchmove",moving),document.removeEventListener("mouseup",moveEnd),document.removeEventListener("mouseleave",moveEnd),document.removeEventListener("touchcancel",moveEnd),document.removeEventListener("touchend",moveEnd),document.removeEventListener("keydown",moveWithKeys)})),i([T,()=>e.step,()=>e.min,()=>e.max],(([e,a,l,r])=>{validateSlider(e,a,l,r)})),i(k,(e=>{document.documentElement.style.cursor=e?"grabbing":""})),{getColor:s,dot:n,dot0:u,dot1:v,orders:A,sliderContainer:d,val:T,sliderClass:L,dotClass:S,labelStyles:V,processedStyles:E,getPinStyles:a=>({backgroundColor:checkActivePin(a)?s(e.color):C(s(e.color)),[h.value]:a*R.value+"%",transition:k.value?"none":"var(--va-slider-pin-transition)"}),dottedStyles:D,clickOnContainer:a=>{if(e.disabled||e.readonly)return;const l=getPos("touches"in a?a.touches[0]:a);Array.isArray(P.value)&&(b.value=l>(P.value[1]-P.value[0])/2+P.value[0]?1:0),k.value=!0,setValueOnPos(l),moveStart(a,b.value)},moveStart:moveStart,hasMouseDown:k,trackStyles:$,pinsCol:j,checkActivePin:checkActivePin,isFocused:c,isActiveDot:isActiveDot,getTrackLabel:(a,l)=>e.trackLabel?"function"==typeof e.trackLabel?e.trackLabel(a,l):void 0:a,currentSliderDotIndex:b,isRange:Array.isArray(e.modelValue)}}});const S={key:0,class:"va-slider__input-wrapper"},V={key:2,class:"va-input__label"},$=["onFocus","tabindex"],E=["tabindex"],D={key:3,class:"va-input__label--inverse"},T={key:5,class:"va-slider__input-wrapper"};L.render=function render(e,a,l,r,t,o){const i=s("va-icon");return n(),u("div",{class:v(["va-slider",e.sliderClass])},[(e.vertical?e.$slots.append:e.$slots.prepend)?(n(),u("div",S,[d(e.$slots,e.vertical?"append":"prepend")])):c("v-if",!0),!e.$slots.label&&!e.label||e.invertLabel?c("v-if",!0):(n(),u("span",{key:1,style:m(e.labelStyles),class:"va-input__label"},[d(e.$slots,"label",{},(()=>[p(y(e.label),1)]))],4)),(e.vertical?e.iconAppend:e.iconPrepend)?(n(),u("span",V,[f(i,{name:e.vertical?e.iconAppend:e.iconPrepend,color:e.getColor(e.$props.color),size:16},null,8,["name","color"])])):c("v-if",!0),b("div",{class:"va-slider__container",ref:"sliderContainer",onMousedown:a[3]||(a[3]=(...a)=>e.clickOnContainer&&e.clickOnContainer(...a)),onTouchstart:a[4]||(a[4]=(...a)=>e.clickOnContainer&&e.clickOnContainer(...a)),onMouseup:a[5]||(a[5]=a=>e.hasMouseDown=!1)},[b("div",{class:"va-slider__track",style:m(e.trackStyles)},null,4),e.pins?(n(!0),u(k,{key:0},A(e.pinsCol,((a,l)=>(n(),u("div",{key:l,class:v(["va-slider__mark",{"va-slider__mark--active":e.checkActivePin(a)}]),style:m(e.getPinStyles(a))},null,6)))),128)):c("v-if",!0),e.isRange?(n(),u(k,{key:1},[b("div",{ref:"process",class:v(["va-slider__track va-slider__track--selected",{"va-slider__track--active":e.isFocused}]),style:m(e.processedStyles)},null,6),(n(!0),u(k,null,A(e.orders,(l=>(n(),u("div",{key:"dot"+l,ref:"dot"+l,class:v(["va-slider__handler",e.dotClass[l]]),style:m(e.dottedStyles[l]),onFocus:a=>(e.isFocused=!0,e.currentSliderDotIndex=l),onBlur:a[0]||(a[0]=a=>e.isFocused=!1),tabindex:e.disabled||e.readonly?void 0:0},[e.isActiveDot(l)?(n(),u("div",{key:0,style:m({backgroundColor:e.getColor(e.$props.color)}),class:"va-slider__handler__dot--focus"},null,4)):c("v-if",!0),e.trackLabelVisible?(n(),u("div",{key:1,style:m(e.labelStyles),class:"va-slider__handler__dot--value"},[d(e.$slots,"trackLabel",h(g({value:e.val[l],order:l})),(()=>[p(y(e.getTrackLabel(e.val[l],l)),1)]))],4)):c("v-if",!0)],46,$)))),128))],64)):(n(),u(k,{key:2},[b("div",{ref:"process",class:v(["va-slider__track va-slider__track--selected",{"va-slider__track--active":e.isFocused}]),style:m(e.processedStyles)},null,6),b("div",{ref:"dot",class:v(["va-slider__handler",e.dotClass]),style:m(e.dottedStyles),onFocus:a[1]||(a[1]=a=>e.isFocused=!0),onBlur:a[2]||(a[2]=a=>e.isFocused=!1),tabindex:e.$props.disabled||e.$props.readonly?void 0:0},[e.isActiveDot(0)?(n(),u("div",{key:0,class:"va-slider__handler__dot--focus",style:m({backgroundColor:e.getColor(e.$props.color)})},null,4)):c("v-if",!0),e.trackLabelVisible?(n(),u("div",{key:1,style:m(e.labelStyles),class:"va-slider__handler__dot--value"},[d(e.$slots,"trackLabel",h(g({value:e.val})),(()=>[p(y(e.getTrackLabel(e.val)),1)]))],4)):c("v-if",!0)],46,E)],64))],544),(e.vertical?e.iconPrepend:e.iconAppend)?(n(),u("span",D,[f(i,{name:e.vertical?e.iconPrepend:e.iconAppend,color:e.getColor(e.$props.color),size:16},null,8,["name","color"])])):c("v-if",!0),(e.$slots.label||e.label)&&e.invertLabel?(n(),u("span",{key:4,style:m(e.labelStyles),class:"va-input__label va-input__label--inverse"},[d(e.$slots,"label",{},(()=>[p(y(e.label),1)]))],4)):c("v-if",!0),(e.vertical?e.$slots.prepend:e.$slots.append)?(n(),u("div",T,[d(e.$slots,e.vertical?"prepend":"append")])):c("v-if",!0)],2)},L.__file="src/components/va-slider/VaSlider.vue";var B=e(L);export{B as default};
//# sourceMappingURL=index44.mjs.map
