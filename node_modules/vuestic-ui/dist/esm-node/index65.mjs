import{w as e}from"./withConfigTransport.mjs";import{defineComponent as t,ref as o,computed as n,onMounted as s,resolveComponent as a,openBlock as l,createBlock as r,Transition as i,withCtx as c,withDirectives as p,createElementVNode as u,normalizeClass as d,normalizeStyle as f,createElementBlock as m,toDisplayString as v,createCommentVNode as g,vShow as C,createVNode as y,withModifiers as T,render as h}from"vue";import{u as x}from"./color-config.mjs";import{u as k}from"./useTextColor.mjs";import{s as b}from"./VaIcon.mjs";import{g as $}from"./ssr-utils.mjs";import{defineVuesticPlugin as _}from"./index56.mjs";import{defineGlobalProperty as I}from"./global-properties.mjs";const S=t({name:"VaToastRenderer",props:{render:{type:Function,required:!0}},setup:e=>()=>e.render()});var V=t({name:"VaToast",components:{VaIcon:b,VaToastRenderer:S},emits:["on-click","on-close"],props:{title:{type:String,default:""},offsetY:{type:Number,default:16},offsetX:{type:Number,default:16},message:{type:[String,Function],default:""},dangerouslyUseHtmlString:{type:Boolean,default:!1},icon:{type:String,default:"close"},customClass:{type:String,default:""},duration:{type:Number,default:5e3},color:{type:String,default:""},closeable:{type:Boolean,default:!0},onClose:{type:Function},onClick:{type:Function},multiLine:{type:Boolean,default:!1},position:{type:String,default:"top-right",validator:e=>["top-right","top-left","bottom-right","bottom-left"].includes(e)},render:{type:Function}},setup(e,{emit:t}){const{getColor:a}=x(),{textColorComputed:l}=k(e.color),r=o(),i=o(!1),c=n((()=>e.position.includes("right")?"right":"left")),p=n((()=>e.position.includes("top")?"top":"bottom")),u=n((()=>[e.customClass,e.multiLine?"va-toast--multiline":""])),d=n((()=>({[p.value]:`${e.offsetY}px`,[c.value]:`${e.offsetX}px`,backgroundColor:a(e.color),color:l.value}))),f=n((()=>"function"==typeof e.message?e.message():e.message)),destroyElement=()=>{var e,t;null===(e=r.value)||void 0===e||e.removeEventListener("transitionend",destroyElement),null===(t=r.value)||void 0===t||t.remove()},onToastClose=()=>{var o;i.value=!1,null===(o=r.value)||void 0===o||o.addEventListener("transitionend",destroyElement),"function"==typeof e.onClose?e.onClose():t("on-close")},m=(()=>{let e;return{start:(...t)=>(e=setTimeout(...t),e),clear:()=>e&&clearTimeout(e)}})(),v=m.clear,startTimer=()=>{e.duration>0&&m.start((()=>i.value&&onToastClose()),e.duration)};return s((()=>{i.value=!0,startTimer()})),{visible:i,toastClasses:u,toastStyles:d,computedMessage:f,onToastClick:()=>{"function"==typeof e.onClick?e.onClick():t("on-click")},onToastClose:onToastClose,startTimer:startTimer,clearTimer:v}}});const j={class:"va-toast__group"},w=["textContent"],M={class:"va-toast__content"},E=["innerHTML"],H=["textContent"],L={key:1,class:"va-toast__content"};V.render=function render(e,t,o,n,s,h){const x=a("VaToastRenderer"),k=a("va-icon");return l(),r(i,{name:"va-toast-fade"},{default:c((()=>[p(u("div",{class:d(["va-toast",...e.toastClasses]),style:f(e.toastStyles),onMouseenter:t[0]||(t[0]=(...t)=>e.clearTimer&&e.clearTimer(...t)),onMouseleave:t[1]||(t[1]=(...t)=>e.startTimer&&e.startTimer(...t)),onClick:t[2]||(t[2]=(...t)=>e.onToastClick&&e.onToastClick(...t)),role:"alert",ref:"rootElement"},[u("div",j,[e.$props.title?(l(),m("h2",{key:0,class:"va-toast__title",textContent:v(e.$props.title)},null,8,w)):g("v-if",!0),p(u("div",M,[e.$props.dangerouslyUseHtmlString?(l(),m("div",{key:0,innerHTML:e.computedMessage},null,8,E)):(l(),m("p",{key:1,textContent:v(e.computedMessage)},null,8,H))],512),[[C,e.$props.message]]),e.$props.render?(l(),m("div",L,[y(x,{render:e.$props.render},null,8,["render"])])):g("v-if",!0),e.$props.closeable?(l(),r(k,{key:2,size:"small",name:e.$props.icon,class:"va-toast__close-icon",onClick:T(e.onToastClose,["stop"])},null,8,["name","onClick"])):g("v-if",!0)])],38),[[C,e.visible]])])),_:1})},V.__file="src/components/va-toast/VaToast.vue";var N=e(V);let X=1;$().vaToastInstances=[];const getNodeProps=e=>{var t;return(null===(t=e.component)||void 0===t?void 0:t.props)||{}},closeNotification=(e,t)=>{var o;if(!e)return;if(!$().vaToastInstances.length)return void(X=1);const n=$().vaToastInstances.findIndex((t=>t===e));if(n<0)return;const s=getNodeProps(e),{offsetX:a,offsetY:l,position:r}=s,i=null===(o=e.el)||void 0===o?void 0:o.offsetHeight;t(),$().vaToastInstances=$().vaToastInstances.reduce(((t,o,s)=>{if(o===e)return t;if(o.component){const{offsetX:e,offsetY:t,position:c}=getNodeProps(o);if(s>n&&a===e&&l===t&&r===c&&o.el&&i){const[e,t]=o.el.style.transform.match(/[\d-]+(?=px)/g),n=((e,t,o)=>{const n=o.includes("bottom")?-1:1;return parseInt(e,10)-(t+5)*n})(t,i,c);o.el.style.transform=`translate(0, ${n}px)`}}return[...t,o]}),[]),$().vaToastInstances.length||(X=1)},mount=(e,{props:t,children:o,element:n,appContext:s}={})=>{let a,l=n;return a=y(e,{...t,onClose:()=>{closeNotification(a,(()=>((e,t)=>{e&&(h(null,e),e.remove()),e=null})(l))),(null==t?void 0:t.onClose)&&t.onClose()}},o),s&&(a.appContext=s),l?h(a,l):"undefined"!=typeof document&&h(a,l=document.createElement("div")),{vNode:a,el:l}},closeAllNotifications=e=>{$().vaToastInstances.length?$().vaToastInstances.forEach((t=>{e&&t.appContext!==e||getNodeProps(t).onClose()})):X=1},closeById=e=>{const t=$().vaToastInstances.find((t=>{var o;return(null===(o=t.el)||void 0===o?void 0:o.id)===e}));if(t){getNodeProps(t).onClose()}},createToastInstance=(e,t)=>{const{vNode:o,el:n}=mount(N,{appContext:t,props:(s=e,"string"==typeof s?{message:s}:s)});var s;const a=getNodeProps(o);if(n&&o.el&&a){document.body.appendChild(n.childNodes[0]);const{offsetX:e,offsetY:t,position:s}=a;o.el.style.display="flex",o.el.id="notification_"+X;let l=0;return $().vaToastInstances.filter((o=>{const{offsetX:n,offsetY:a,position:l}=getNodeProps(o);return n===e&&a===t&&s===l})).forEach((e=>{l+=((e,t)=>{if(e.el){const o=t.includes("bottom")?-1:1;return(e.el.offsetHeight+5)*o}return 0})(e,s)})),o.el.style.transform=`translate(0, ${l}px)`,X+=1,$().vaToastInstances.push(o),o.el.id}return null},Y=_((()=>({install(e){I(e,"$vaToast",(e=>({init:t=>createToastInstance(t,null==e?void 0:e._context),close(e){closeById(e)},closeAll(t=!1){closeAllNotifications(t||null==e?void 0:e._context)}}))(e))}}))),D={closeDropdown(){let e=this;for(;e=e.$parent;){if("VaDropdown"===e.$options.name){e.hide();break}}}},F=_((()=>({install(e){I(e,"$closeDropdown",D.closeDropdown),I(e,"$vaDropdown",D)}})));export{Y as V,closeById as a,closeAllNotifications as b,createToastInstance as c,F as d};
//# sourceMappingURL=index65.mjs.map
