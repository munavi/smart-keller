import{ref as e,onMounted as t,onBeforeUnmount as a,watch as r,computed as o,defineComponent as l,nextTick as n,mergeProps as s,toRefs as u,resolveComponent as i,createSlots as c,withCtx as p,openBlock as d,createBlock as m,createCommentVNode as v,withModifiers as g,renderSlot as f,renderList as y}from"vue";import{u as b}from"./useForm.js";import{b as h,u as x,a as V}from"./index66.js";import w from"cleave.js";import{u as k}from"./useFocus.js";import{u as _}from"./useEmitProxy.js";import{s as I}from"./VaInputWrapper.js";import{p as P}from"./pick.js";import{ssrRenderAttrs as S,ssrInterpolate as R,ssrRenderComponent as z,ssrRenderSlot as B}from"@vue/server-renderer";import{s as C,o as E}from"./VaIcon.js";import{f as F,e as $}from"./child-props.js";const j={creditCard:{creditCard:!0},date:{date:!0,datePattern:["d","m","Y"]},time:{time:!0,timePattern:["h","m"],timeFormat:"24"},numeral:{numeral:!0,numeralThousandsGroupStyle:"thousand"}},A={mask:{type:[String,Object],default:""},returnRaw:{type:Boolean,default:!0},modelValue:{type:String}},useCleave=(l,n,s)=>{const u=e(),destroyCleave=()=>{u.value&&u.value.destroy()},initCleave=()=>{var e;(destroyCleave(),l.value)&&(u.value=new w(l.value,"string"==typeof(e=n.mask)?j[e]?{...j[e]}:{}:{...e}))};t((()=>{initCleave()})),a((()=>{destroyCleave()})),r((()=>[l.value,n.mask]),(()=>{initCleave()}));const i=o((()=>u.value&&n.returnRaw&&n.modelValue===u.value.getRawValue()?u.value.getFormattedValue():n.modelValue));return{cleave:u,computedValue:i,onInput:e=>{const t=e.target.value;("string"===n.mask||Object.keys(n.mask).length)&&u.value&&(u.value.setRawValue(t),n.returnRaw)?s("update:modelValue",u.value.getRawValue()):s("update:modelValue",t)}}},H={clearable:{type:Boolean,default:!1},clearableIcon:{type:String,default:"highlight_off"},clearValue:{type:String,default:""}},L=["clear"],useClearable=(e,t,a,r,l)=>{const{isFocused:n,onFocus:s,onBlur:u}=k(r,a),i=[null,void 0,e.clearValue],c=o((()=>e.clearable&&!e.disabled&&!e.readonly&&!i.includes(t.value))),p=o((()=>(null==n?void 0:n.value)?e.color||"primary":(null==l?void 0:l.value)?"danger":e.success?"success":"gray")),d=o((()=>({name:e.clearableIcon,color:p.value,size:"small"})));return{canBeCleared:c,clearIconColor:p,clearIconProps:d,onFocus:s,onBlur:u}},M=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],getNodeHeightStyles=e=>{const t=window.getComputedStyle(e);return{boxSizing:t.getPropertyValue("box-sizing")||t.getPropertyValue("-moz-box-sizing")||t.getPropertyValue("-webkit-box-sizing"),padding:parseFloat(t.getPropertyValue("padding-bottom"))+parseFloat(t.getPropertyValue("padding-top")),border:parseFloat(t.getPropertyValue("border-bottom-width"))+parseFloat(t.getPropertyValue("border-top-width")),styles:M.map((e=>`${e}:${t.getPropertyValue(e)}`)).join(";")+";",lineHeight:parseInt(t.getPropertyValue("line-height"))}};let T=null;const createHiddenTextarea=(e,t)=>{T||(T=document.createElement("textarea")),T.setAttribute("style",t+"\n  min-height:0 !important;\n  max-height:none !important;\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  right:0 !important';\n"),T.value=e.value||e.placeholder||"";const a=e.getAttribute("wrap");return null!==a?T.setAttribute("wrap",a):T.removeAttribute("wrap"),T},positiveNumberValidator=e=>{if(e>0&&(0|e)===e)return!0;throw new Error(`\`minRows|maxRows\` must be a positive integer greater than 0, but ${e} is provided`)},{createEmits:N,createListeners:q}=_(["input","change","click","update:modelValue"]);var O=l({name:"VaTextarea",props:{...b,modelValue:{type:[String,Number],default:""},placeholder:{type:String},autosize:{type:Boolean,default:!1},minRows:{type:Number,default:1,validator:positiveNumberValidator},maxRows:{type:Number,validator:positiveNumberValidator}},emits:N(),setup(a,{emit:l}){const s=e(),u=e(-1),i=e(-1),{calculateRowHeight:c,calculateHeight:p}=(e=>({calculateRowHeight:()=>e.value?getNodeHeightStyles(e.value).lineHeight:0,calculateHeight:()=>{if(!e.value)return 0;const{boxSizing:t,padding:a,border:r,styles:o}=getNodeHeightStyles(e.value),l=createHiddenTextarea(e.value,o);document.body.appendChild(l);let n=l.scrollHeight;return"border-box"===t?n+=r:"content-box"===t&&(n-=a),document.body.removeChild(l),n}}))(s),d=o((()=>Boolean((a.autosize||a.maxRows||1!==a.minRows)&&s.value))),updateHeight=()=>{d.value&&(i.value=p())};t((()=>{d.value&&(u.value=c()),updateHeight()})),r((()=>a.modelValue),(()=>{n(updateHeight)}));const m=o((()=>({minHeight:u.value*a.minRows+"px",maxHeight:a.maxRows?u.value*a.maxRows+"px":void 0,height:i.value+"px",resize:d.value?void 0:"none"}))),v=o((()=>({...P(a,["disabled","readonly","placeholder"])})));return{textarea:s,computedStyle:m,listeners:q(l),computedProps:v}},methods:{focus(){var e;null===(e=this.textarea)||void 0===e||e.focus()},blur(){var e;null===(e=this.textarea)||void 0===e||e.blur()}}});O.ssrRender=function ssrRender$1(e,t,a,r,o,l,n,u){let i;t(`<textarea${S(i=s({ref:"textarea",class:"textarea"},{...e.computedProps,...e.listeners},{value:e.modelValue,style:e.computedStyle},r),"textarea")}>${R("value"in i?i.value:"")}</textarea>`)},O.__file="src/components/va-input/components/VaTextarea/VaTextarea.vue";const W=$(O),{createEmits:G,createListeners:Y}=_(["change","keyup","keypress","keydown","focus","blur"]),{createEmits:D,createListeners:J}=_(["click","click-prepend","click-append","click-prepend-inner","click-append-inner","click-icon"]);var K=l({name:"VaInput",components:{VaInputWrapper:I,VaTextarea:O,VaIcon:C},props:{...b,...h,...H,...A,...W,placeholder:{type:String,default:""},tabindex:{type:Number,default:0},modelValue:{type:[String,Number],default:""},label:{type:String,default:""},type:{type:String,default:"text"},loading:{type:Boolean,default:!1},inputClass:{type:String,default:""},pattern:{type:String},inputmode:{type:String,default:"text"},color:{type:String,default:"primary"},outline:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},requiredMark:{type:Boolean,default:!1}},emits:["update:modelValue",...x,...L,...G(),...D()],inheritAttrs:!1,setup(t,{emit:a,attrs:r,slots:l}){const n=e(),{isFocused:s,onFocus:i,onBlur:c}=k(),reset=()=>{a("update:modelValue",t.clearValue),a("clear")},p=o((()=>{const e=["icon"];return Object.keys(l).filter((t=>!e.includes(t)))})),{computedError:d,computedErrorMessages:m,listeners:v}=V(t,a,reset,(()=>{var e;null===(e=n.value)||void 0===e||e.focus()})),{modelValue:g}=u(t),{canBeCleared:f,clearIconProps:y}=useClearable(t,g,a,n,d),b=o((()=>"textarea"===t.type?void 0:n.value)),{computedValue:h,onInput:x}=useCleave(b,t,a),w=Y(a),_={...w,onFocus:e=>{w.onFocus(e),v.onFocus(),i()},onBlur:e=>{w.onBlur(e),v.onBlur(),c()},onInput:x},I=o((()=>({ariaLabel:t.label,class:t.inputClass,...E(r,["class","style"])}))),S=o((()=>({...I.value,...P(t,["type","tabindex","disabled","readonly","placeholder","pattern","inputmode"])})));return{input:n,inputEvents:_,computedChildAttributes:I,computedInputAttributes:S,textareaProps:F(t,W),computedValue:h,computedError:d,computedErrorMessages:m,isFocused:s,canBeCleared:f,clearIconProps:y,fieldListeners:J(a),reset:reset,filterSlots:p}},methods:{focus(){var e;null===(e=this.input)||void 0===e||e.focus()},blur(){var e;null===(e=this.input)||void 0===e||e.blur()}}});K.ssrRender=function ssrRender(e,t,a,r,o,l,n,u){const b=i("VaInputWrapper"),h=i("va-icon"),x=i("VaTextarea");t(z(b,s(e.fieldListeners,{class:e.$attrs.class,style:e.$attrs.style,color:e.color,readonly:e.readonly,disabled:e.disabled,success:e.success,messages:e.messages,error:e.computedError,"error-messages":e.computedErrorMessages,"error-count":e.errorCount,label:e.label,bordered:e.bordered,outline:e.outline,focused:e.isFocused,requiredMark:e.requiredMark},r),c({icon:p(((t,a,r,o)=>{if(!a)return[e.success?(d(),m(h,{key:0,color:"success",name:"check_circle",size:"small"})):v("v-if",!0),e.computedError?(d(),m(h,{key:1,color:"danger",name:"warning",size:"small"})):v("v-if",!0),e.canBeCleared?(d(),m(h,s({key:2},e.clearIconProps,{onClick:g((t=>e.reset()),["stop"])}),null,16,["onClick"])):v("v-if",!0),e.loading?(d(),m(h,{key:3,color:e.color,size:"small",name:"loop",spin:"counter-clockwise"},null,8,["color"])):v("v-if",!0),f(e.$slots,"icon",t)];e.success?a(z(h,{color:"success",name:"check_circle",size:"small"},null,r,o)):a("\x3c!----\x3e"),e.computedError?a(z(h,{color:"danger",name:"warning",size:"small"},null,r,o)):a("\x3c!----\x3e"),e.canBeCleared?a(z(h,e.clearIconProps,null,r,o)):a("\x3c!----\x3e"),e.loading?a(z(h,{color:e.color,size:"small",name:"loop",spin:"counter-clockwise"},null,r,o)):a("\x3c!----\x3e"),B(e.$slots,"icon",t,null,a,r,o)})),default:p(((t,a,r,o)=>{if(!a)return["textarea"!==e.type||e.$slots.content?e.$slots.content?v("v-if",!0):(d(),m("input",s({key:1,ref:"input",class:"va-input__content__input"},{...e.computedInputAttributes,...e.inputEvents},{value:e.computedValue}),null,16,["value"])):(d(),m(x,s({key:0,ref:"input"},{...e.computedChildAttributes,...e.textareaProps,...e.inputEvents},{class:"va-input__content__input"}),null,16))];"textarea"!==e.type||e.$slots.content?e.$slots.content?a("\x3c!----\x3e"):a(`<input${S(s({ref:"input",class:"va-input__content__input"},{...e.computedInputAttributes,...e.inputEvents},{value:e.computedValue}))}${o}>`):a(z(x,s({ref:"input"},{...e.computedChildAttributes,...e.textareaProps,...e.inputEvents},{class:"va-input__content__input"}),null,r,o))})),_:2},[y(e.filterSlots,(t=>({name:t,fn:p(((a,r,o,l)=>{if(!r)return[f(e.$slots,e.name,a)];B(e.$slots,t,a,null,r,o,l)}))})))]),a))},K.__file="src/components/va-input/VaInput.vue";export{useClearable as a,H as b,K as s,L as u};
//# sourceMappingURL=VaInput.js.map
